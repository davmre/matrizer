X: n x m
w: m x 1
d: m x 1

n ~ 100
m ~ 2

r = d' * X' * X * w + w' * X' * X * d